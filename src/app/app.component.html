<div class="container">
  <h1>RxJS Observable Examples</h1>
  
  <!-- Loading indicator -->
  <div *ngIf="loading$ | async" class="loading-indicator">
    Loading...
  </div>
  
  <!-- Notifications area - using async pipe to get the array of notifications -->
  <div class="notifications">
    <ng-container *ngIf="notifications$ | async as notificationsList">
      <div *ngFor="let notification of notificationsList" class="notification">
        {{ notification }}
      </div>
    </ng-container>
  </div>
  
  <section>
    <h2>Async Pipe Example</h2>
    <ul>
      <li *ngFor="let item of data$ | async">{{ item }}</li>
    </ul>
  </section>
  
  <section>
    <h2>BehaviorSubject Counter</h2>
    <div class="counter">
      <p>Current Count: {{ counter$ | async }}</p>
      <button (click)="decrementCounter()">-</button>
      <button (click)="incrementCounter()">+</button>
    </div>
  </section>
  
  <section>
    <h2>JSONPlaceholder User Search</h2>
    <p class="api-info">Using server-side filtering with JSONPlaceholder API</p>
    
    <!-- Using our reusable SearchComponent -->
    <app-search 
      placeholder="Search users by name, username, or email..."
      [loading]="(loading$ | async) === true"
      (search)="onUserSearch($event)">
    </app-search>
    
    <div class="results">
      <p *ngIf="(searchResults$ | async)?.length === 0">No users found</p>
      <div *ngIf="(searchResults$ | async) as users">
        <div *ngFor="let user of users" class="user-card">
          <h3>{{ user.name }}</h3>
          <p><strong>Username:</strong> {{ user.username }}</p>
          <p><strong>Email:</strong> {{ user.email }}</p>
          <p *ngIf="user.phone"><strong>Phone:</strong> {{ user.phone }}</p>
          <p *ngIf="user.website"><strong>Website:</strong> {{ user.website }}</p>
          <button (click)="loadUserWithPosts(user.id)">Load Posts</button>
        </div>
      </div>
    </div>
  </section>
  
  <section>
    <h2>JSONPlaceholder Post Search</h2>
    <p class="api-info">Using server-side filtering with JSONPlaceholder API</p>
    
    <!-- Using our reusable SearchComponent -->
    <app-search 
      placeholder="Search posts by title or content..."
      [loading]="(loading$ | async) === true"
      (search)="onPostSearch($event)">
    </app-search>
    
    <div class="results">
      <p *ngIf="(posts$ | async)?.length === 0">No posts found</p>
      <div *ngIf="(posts$ | async) as posts">
        <div *ngFor="let post of posts.slice(0, 5)" class="post-card">
          <h3>{{ post.title }}</h3>
          <p>{{ post.body }}</p>
        </div>
        <p *ngIf="posts.length > 5" class="more-results">Showing 5 of {{ posts.length }} results...</p>
      </div>
    </div>
  </section>
  
  <section>
    <h2>User with Posts (Combined Observables)</h2>
    <p class="api-info">Using combineLatest with server-filtered API requests</p>
    
    <div *ngIf="userWithPosts$ | async as userData">
      <div *ngIf="!userData.error; else errorTpl">
        <div class="user-details">
          <h3>{{ userData.name }}</h3>
          <p><strong>Username:</strong> {{ userData.username }}</p>
          <p><strong>Email:</strong> {{ userData.email }}</p>
        </div>
        
        <h4>Posts by {{ userData.name }}</h4>
        <div *ngIf="userData.posts.length === 0">No posts found</div>
        <div *ngFor="let post of userData.posts.slice(0, 3)" class="post-card">
          <h3>{{ post.title }}</h3>
          <p>{{ post.body }}</p>
        </div>
        <p *ngIf="userData.posts.length > 3" class="more-results">
          Showing 3 of {{ userData.posts.length }} posts...
        </p>
      </div>
      
      <ng-template #errorTpl>
        <div class="error-message">
          Error loading user data: {{ userData.error }}
        </div>
      </ng-template>
    </div>
    
    <div class="user-navigation">
      <button (click)="loadUserWithPosts(selectedUserId > 1 ? selectedUserId - 1 : 10)">Previous User</button>
      <span>User ID: {{ selectedUserId }}</span>
      <button (click)="loadUserWithPosts(selectedUserId < 10 ? selectedUserId + 1 : 1)">Next User</button>
    </div>
  </section>
  
  <section>
    <h2>Error Handling</h2>
    <button (click)="triggerError()">Trigger Error</button>
    <p>Check console for results</p>
  </section>
  
  <section>
    <h2>Console Examples</h2>
    <p>Open your browser console to see the following examples in action:</p>
    <ul>
      <li>Basic Observable subscription with operators</li>
      <li>Interval Observable</li>
      <li>Error handling</li>
    </ul>
  </section>
</div>

<router-outlet></router-outlet>
